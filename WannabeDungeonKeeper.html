<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Wannabe Dungeon Keeper</title>
<script type="text/javascript" src="phaser.min.js"> </script>

<style type="text/css">

body{
	background-color:#00F;
	}
h1{
	text-align:center;
	size:24px;
	color:#000;	
	}
#Game{
	margin-left:auto;
	margin-right:auto;
	width:800px;
	}

</style>
</head>

<!-- BODYYYYYYYYY-->


<body>
<h1>
WANNABE DUNGEON KEEPER
</h1>
<div id="Game">
<script type="text/javascript">
var game = new Phaser.Game(896, 640, Phaser.CANVAS,"Game" ,{ preload: preload, create: create });
var map;
var layer;
var enemySprite;
var happy_wall_sprite;
var Eel_Trap_Sprite;
var Bamboo_Spear_Trap_Sprite;
var tileX = 4;
var tileY = 4;

function preload(){
	game.load.tilemap("dirt-map","Tiles/Dirt-Map.json", null ,Phaser.Tilemap.TILED_JSON);
	game.load.image("dirt-tiles","x64/DirtFloorSheet.png");
	game.load.image("Black-Collision","x64/Black-Collision.png")
	game.load.image("Proto-Enemy","x64/Proto-Enemy.png");
	game.load.spritesheet("Happy-Wall","x64/HappyWallSheet.png", 64,64,12);
	game.load.spritesheet("Eel_Trap","x64/Eel-Trap-Spritesheet.png", 64,64,7);
	game.load.spritesheet("Bamboo_Spear","x64/BambooSpearTrapSheet.png", 64,64,12);

	}
	
function create(){
	/*for(i = 0;i < 10;i++){
		for(o = 0;o<10;o++){
			game.add.sprite((i*64)+80,(o*64),"dirtblock");
		}
	}*/
	game.physics.startSystem(Phaser.Physics.ARCADE);
	
	map = game.add.tilemap("dirt-map");
	
	map.addTilesetImage("DirtFloor","dirt-tiles");
	map.addTilesetImage("Collision-Image","Black-Collision");
	
	layer = map.createLayer("Cave-Floor");
//	layer = map.createLayer("Collisions");
	
	enemySprite = game.add.sprite(200,200,"Proto-Enemy");
	enemySprite.anchor.setTo(0.5,0.5);
	
	game.physics.enable(enemySprite);
//	game.camera.follow(sprite);


	happy_wall_sprite = game.add.sprite((64*tileX) + 128,64*tileY,"Happy-Wall");
	happy_wall_sprite.angle = 90;
	happy_wall_sprite.animations.add("Wall-Smash");
	happy_wall_sprite.animations.play("Wall-Smash",15,true);
	
	Eel_Trap_Sprite = game.add.sprite((64*(tileX+2))+128,64*(tileY+2),"Eel_Trap");
	Eel_Trap_Sprite.angle = 90;
	Eel_Trap_Sprite.animations.add("Idle-Trap");
	Eel_Trap_Sprite.animations.play("Idle-Trap",10,true);
	
	Bamboo_Spear_Trap_Sprite = game.add.sprite((64*(tileX))+128,64*(tileY+1),"Bamboo_Spear");
	Bamboo_Spear_Trap_Sprite.angle = -90;
	Bamboo_Spear_Trap_Sprite.animations.add("Bamboo-Lunge");
	Bamboo_Spear_Trap_Sprite.animations.play("Bamboo-Lunge",10,true);
	
	cursors = game.input.keyboard.createCursorKeys();

    //game.input.onDown.add(fillTiles, this);

}
function update()
{
	game.physics.arcade.collide(enemySprite, layer);

	enemySprite.body.velocity.x = 0;
	enemySprite.body.velocity.y = 0;
	
	 if (cursors.left.isDown)
    {
        enemySprite.body.angularVelocity = -200;
    }
    else if (cursors.right.isDown)
    {
        enemySprite.body.angularVelocity = 200;
    }

    if (cursors.up.isDown)
    {
        enemySprite.body.velocity.copyFrom(game.physics.arcade.velocityFromAngle(sprite.angle, 300));
    }
}

function render()
{
	game.debug.text('Tile X: ' + layer.getTileX(enemySprite.x), 32, 48, 'rgb(0,0,0)');
    game.debug.text('Tile Y: ' + layer.getTileY(enemySprite.y), 32, 64, 'rgb(0,0,0)');


}




</script>
</div>








</body>
</html>
